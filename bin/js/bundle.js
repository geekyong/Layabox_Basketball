var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**This class is automatically generated by LayaAirIDE, please do not make any modifications. */
var GameMgr_1 = require("./script/GameMgr");
/*
* 游戏初始化配置;
*/
var GameConfig = /** @class */ (function () {
    function GameConfig() {
    }
    GameConfig.init = function () {
        var reg = Laya.ClassUtils.regClass;
        reg("script/GameMgr.ts", GameMgr_1.default);
    };
    GameConfig.width = 960;
    GameConfig.height = 640;
    GameConfig.scaleMode = "fixedheight";
    GameConfig.screenMode = "none";
    GameConfig.alignV = "middle";
    GameConfig.alignH = "center";
    GameConfig.startScene = "game.scene";
    GameConfig.sceneRoot = "";
    GameConfig.debug = false;
    GameConfig.stat = false;
    GameConfig.physicsDebug = false;
    GameConfig.exportSceneToJson = true;
    return GameConfig;
}());
exports.default = GameConfig;
GameConfig.init();
},{"./script/GameMgr":4}],2:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var GameConfig_1 = require("./GameConfig");
var Main = /** @class */ (function () {
    function Main() {
        //根据IDE设置初始化引擎		
        if (window["Laya3D"])
            Laya3D.init(GameConfig_1.default.width, GameConfig_1.default.height);
        else
            Laya.init(GameConfig_1.default.width, GameConfig_1.default.height, Laya["WebGL"]);
        Laya["Physics"] && Laya["Physics"].enable();
        Laya["DebugPanel"] && Laya["DebugPanel"].enable();
        Laya.stage.scaleMode = GameConfig_1.default.scaleMode;
        Laya.stage.screenMode = GameConfig_1.default.screenMode;
        //兼容微信不支持加载scene后缀场景
        Laya.URL.exportSceneToJson = GameConfig_1.default.exportSceneToJson;
        //打开调试面板（通过IDE设置调试模式，或者url地址增加debug=true参数，均可打开调试面板）
        if (GameConfig_1.default.debug || Laya.Utils.getQueryString("debug") == "true")
            Laya.enableDebugPanel();
        if (GameConfig_1.default.physicsDebug && Laya["PhysicsDebugDraw"])
            Laya["PhysicsDebugDraw"].enable();
        if (GameConfig_1.default.stat)
            Laya.Stat.show();
        Laya.alertGlobalError = true;
        //激活资源版本控制，version.json由IDE发布功能自动生成，如果没有也不影响后续流程
        Laya.ResourceVersion.enable("version.json", Laya.Handler.create(this, this.onVersionLoaded), Laya.ResourceVersion.FILENAME_VERSION);
    }
    Main.prototype.onVersionLoaded = function () {
        //激活大小图映射，加载小图的时候，如果发现小图在大图合集里面，则优先加载大图合集，而不是小图
        Laya.AtlasInfoManager.enable("fileconfig.json", Laya.Handler.create(this, this.onConfigLoaded));
    };
    Main.prototype.onConfigLoaded = function () {
        //加载IDE指定的场景
        GameConfig_1.default.startScene && Laya.Scene.open(GameConfig_1.default.startScene);
    };
    return Main;
}());
//激活启动类
new Main();
},{"./GameConfig":1}],3:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var BallCtrl = /** @class */ (function (_super) {
    __extends(BallCtrl, _super);
    function BallCtrl() {
        var _this = _super.call(this) || this;
        _this.maxForce = 6.5;
        _this.minForce = 4.5;
        return _this;
    }
    BallCtrl.prototype.onAwake = function () {
        this.rigid = this.owner.getComponent(Laya.Rigidbody3D);
        Laya.stage.on(Laya.Event.MOUSE_DOWN, this, this.onMouseDown);
        Laya.stage.on(Laya.Event.MOUSE_UP, this, this.onMouseUp);
        this.curBallState = BallState.Idle;
        this.groupSpeed = (this.maxForce - this.minForce) / 2.5;
        this.addForce = 0;
    };
    BallCtrl.prototype.onUpdate = function () {
        var dt = Laya.timer.delta / 1000;
        if (this.curBallState == BallState.AddForce) {
            this.addForce += dt * this.groupSpeed;
            if (this.addForce > this.maxForce - this.minForce) {
                this.addForce = this.maxForce - this.minForce;
            }
            var per = this.addForce / (this.maxForce - this.minForce);
            per = per > 1 ? 1 : per;
            Laya.stage.event("set_slider_value", per);
        }
    };
    BallCtrl.prototype.onMouseDown = function () {
        console.log("onMouseDown!");
        Laya.stage.event("hideTweener");
        if (this.curBallState != BallState.Idle) {
            return;
        }
        this.curBallState = BallState.AddForce;
    };
    BallCtrl.prototype.onMouseUp = function () {
        console.log("onMouseUp!");
        if (this.curBallState != BallState.AddForce) {
            return;
        }
        this.curBallState = BallState.Throw;
        this.thorwBall();
    };
    BallCtrl.prototype.thorwBall = function () {
        if (this.curBallState != BallState.Throw) {
            return;
        }
        var speed = this.minForce + this.addForce;
        var vy = speed * Math.sin(Math.PI / 4);
        var vz = vy;
        this.rigid.linearVelocity = new Laya.Vector3(0, vy, vz);
        this.rigid.gravity = new Laya.Vector3(0, -10, 0);
        Laya.timer.once(5000, this, this.onCheckOut);
    };
    BallCtrl.prototype.onCheckOut = function () {
        this.owner.removeSelf();
        Laya.stage.event("gen_new_ball");
    };
    BallCtrl.prototype.onTriggerEnter = function (other) {
        if (this.curBallState == BallState.None) {
            return;
        }
        Laya.stage.event("success");
        this.curBallState = BallState.None;
    };
    BallCtrl.prototype.onDestroy = function () {
        Laya.stage.off(Laya.Event.MOUSE_DOWN, this, this.onMouseDown);
        Laya.stage.off(Laya.Event.MOUSE_UP, this, this.onMouseUp);
    };
    return BallCtrl;
}(Laya.Script3D));
exports.default = BallCtrl;
var BallState;
(function (BallState) {
    BallState[BallState["None"] = 0] = "None";
    BallState[BallState["Idle"] = 1] = "Idle";
    BallState[BallState["AddForce"] = 2] = "AddForce";
    BallState[BallState["Throw"] = 3] = "Throw";
})(BallState || (BallState = {}));
},{}],4:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var BallCtrl_1 = require("./BallCtrl");
var GameMgr = /** @class */ (function (_super) {
    __extends(GameMgr, _super);
    function GameMgr() {
        return _super.call(this) || this;
    }
    Object.defineProperty(GameMgr.prototype, "score", {
        get: function () {
            return this._score;
        },
        set: function (v) {
            this._score = v;
            this.scoreText.text = this._score + "";
        },
        enumerable: true,
        configurable: true
    });
    GameMgr.prototype.onAwake = function () {
        var _this = this;
        Laya.Scene3D.load("res/scenes3D/LayaScene_game_scene/Conventional/game_scene.ls", Laya.Handler.create(this, this.onLoadSceneCmp));
        Laya.stage.on("gen_new_ball", this, this.onGenNewBall);
        Laya.stage.on("set_slider_value", this, this.SetSliderValue);
        Laya.stage.on("success", this, this.OnGoal);
        this.SetSliderValue(0);
        this.score = 0;
        this.tweenOver2();
        Laya.stage.on("hideTweener", this, function () {
            if (_this.hintText.visible == true) {
                _this.tweener1.clear();
                _this.tweener2.clear();
                _this.hintText.visible = false;
            }
        });
    };
    GameMgr.prototype.tweenOver1 = function () {
        if (this.tweener1 != null) {
            this.tweener1.clear();
        }
        this.tweener2 = Laya.Tween.to(this.hintText, { "alpha": 1 }, 500, Laya.Ease.linearNone, Laya.Handler.create(this, this.tweenOver2));
    };
    GameMgr.prototype.tweenOver2 = function () {
        if (this.tweener2 != null) {
            this.tweener2.clear();
        }
        this.tweener1 = Laya.Tween.to(this.hintText, { "alpha": 0 }, 500, Laya.Ease.linearNone, Laya.Handler.create(this, this.tweenOver1));
    };
    GameMgr.prototype.SetSliderValue = function (value) {
        if (value < 0 || value >= 1) {
            return;
        }
        this.hSlider.value = value;
    };
    GameMgr.prototype.onGenNewBall = function () {
        this.SetSliderValue(0);
        var newball = Laya.Sprite3D.instantiate(this.ball_prefab);
        this.scene3D.addChild(newball);
    };
    //得分
    GameMgr.prototype.OnGoal = function () {
        console.log(this.part.name);
        this.part.particleSystem.play();
        this.score++;
    };
    GameMgr.prototype.onLoadSceneCmp = function (scenes3D) {
        Laya.stage.addChild(scenes3D);
        this.scene3D = scenes3D;
        scenes3D.zOrder = -1;
        var ball = scenes3D.getChildByName("ball");
        ball.addComponent(BallCtrl_1.default);
        this.ball_prefab = Laya.Sprite3D.instantiate(ball);
        this.part = scenes3D.getChildByName("particle");
    };
    GameMgr.prototype.onEnable = function () {
        console.log("onEnable!!!!!");
    };
    GameMgr.prototype.onDisable = function () {
    };
    return GameMgr;
}(Laya.Script));
exports.default = GameMgr;
},{"./BallCtrl":3}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL1dvcmtTb2Z0d2FyZS9MYXlhSURFIDIuMS4wL3Jlc291cmNlcy9hcHAvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsInNyYy9HYW1lQ29uZmlnLnRzIiwic3JjL01haW4udHMiLCJzcmMvc2NyaXB0L0JhbGxDdHJsLnRzIiwic3JjL3NjcmlwdC9HYW1lTWdyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ1ZBLGdHQUFnRztBQUNoRyw0Q0FBc0M7QUFDdEM7O0VBRUU7QUFDRjtJQWFJO0lBQWMsQ0FBQztJQUNSLGVBQUksR0FBWDtRQUNJLElBQUksR0FBRyxHQUFhLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDO1FBQzdDLEdBQUcsQ0FBQyxtQkFBbUIsRUFBQyxpQkFBTyxDQUFDLENBQUM7SUFDckMsQ0FBQztJQWhCTSxnQkFBSyxHQUFRLEdBQUcsQ0FBQztJQUNqQixpQkFBTSxHQUFRLEdBQUcsQ0FBQztJQUNsQixvQkFBUyxHQUFRLGFBQWEsQ0FBQztJQUMvQixxQkFBVSxHQUFRLE1BQU0sQ0FBQztJQUN6QixpQkFBTSxHQUFRLFFBQVEsQ0FBQztJQUN2QixpQkFBTSxHQUFRLFFBQVEsQ0FBQztJQUN2QixxQkFBVSxHQUFLLFlBQVksQ0FBQztJQUM1QixvQkFBUyxHQUFRLEVBQUUsQ0FBQztJQUNwQixnQkFBSyxHQUFTLEtBQUssQ0FBQztJQUNwQixlQUFJLEdBQVMsS0FBSyxDQUFDO0lBQ25CLHVCQUFZLEdBQVMsS0FBSyxDQUFDO0lBQzNCLDRCQUFpQixHQUFTLElBQUksQ0FBQztJQU0xQyxpQkFBQztDQWxCRCxBQWtCQyxJQUFBO2tCQWxCb0IsVUFBVTtBQW1CL0IsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDOzs7O0FDeEJsQiwyQ0FBc0M7QUFDdEM7SUFDQztRQUNDLGdCQUFnQjtRQUNoQixJ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RCxJQUFJO0lBQ0ksd0JBQU0sR0FBZDtRQUNJLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM1QixJQUFJLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNoQyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDakIsQ0FBQztJQUVPLGdDQUFjLEdBQXRCLFVBQXVCLFFBQXNCO1FBQ3pDLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRTlCLElBQUksQ0FBQyxPQUFPLEdBQUcsUUFBUSxDQUFDO1FBQ3hCLFFBQVEsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDckIsSUFBSSxJQUFJLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUMzQyxJQUFJLENBQUMsWUFBWSxDQUFDLGtCQUFRLENBQUMsQ0FBQztRQUU1QixJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLElBQXFCLENBQUMsQ0FBQztRQUNwRSxJQUFJLENBQUMsSUFBSSxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUE0QixDQUFDO0lBQy9FLENBQUM7SUFFRCwwQkFBUSxHQUFSO1FBQ0ksT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsQ0FBQztJQUNqQyxDQUFDO0lBRUQsMkJBQVMsR0FBVDtJQUNBLENBQUM7SUFDTCxjQUFDO0FBQUQsQ0ExR0EsQUEwR0MsQ0ExR29DLElBQUksQ0FBQyxNQUFNLEdBMEcvQyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIvKipUaGlzIGNsYXNzIGlzIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVkIGJ5IExheWFBaXJJREUsIHBsZWFzZSBkbyBub3QgbWFrZSBhbnkgbW9kaWZpY2F0aW9ucy4gKi9cclxuaW1wb3J0IEdhbWVNZ3IgZnJvbSBcIi4vc2NyaXB0L0dhbWVNZ3JcIlxyXG4vKlxyXG4qIOa4uOaIj+WIneWni+WMlumFjee9rjtcclxuKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZUNvbmZpZ3tcclxuICAgIHN0YXRpYyB3aWR0aDpudW1iZXI9OTYwO1xyXG4gICAgc3RhdGljIGhlaWdodDpudW1iZXI9NjQwO1xyXG4gICAgc3RhdGljIHNjYWxlTW9kZTpzdHJpbmc9XCJmaXhlZGhlaWdodFwiO1xyXG4gICAgc3RhdGljIHNjcmVlbk1vZGU6c3RyaW5nPVwibm9uZVwiO1xyXG4gICAgc3RhdGljIGFsaWduVjpzdHJpbmc9XCJtaWRkbGVcIjtcclxuICAgIHN0YXRpYyBhbGlnbkg6c3RyaW5nPVwiY2VudGVyXCI7XHJcbiAgICBzdGF0aWMgc3RhcnRTY2VuZTphbnk9XCJnYW1lLnNjZW5lXCI7XHJcbiAgICBzdGF0aWMgc2NlbmVSb290OnN0cmluZz1cIlwiO1xyXG4gICAgc3RhdGljIGRlYnVnOmJvb2xlYW49ZmFsc2U7XHJcbiAgICBzdGF0aWMgc3RhdDpib29sZWFuPWZhbHNlO1xyXG4gICAgc3RhdGljIHBoeXNpY3NEZWJ1Zzpib29sZWFuPWZhbHNlO1xyXG4gICAgc3RhdGljIGV4cG9ydFNjZW5lVG9Kc29uOmJvb2xlYW49dHJ1ZTtcclxuICAgIGNvbnN0cnVjdG9yKCl7fVxyXG4gICAgc3RhdGljIGluaXQoKXtcclxuICAgICAgICB2YXIgcmVnOiBGdW5jdGlvbiA9IExheWEuQ2xhc3NVdGlscy5yZWdDbGFzcztcclxuICAgICAgICByZWcoXCJzY3JpcHQvR2FtZU1nci50c1wiLEdhbWVNZ3IpO1xyXG4gICAgfVxyXG59XHJcbkdhbWVDb25maWcuaW5pdCgpOyIsImltcG9ydCBHYW1lQ29uZmlnIGZyb20gXCIuL0dhbWVDb25maWdcIjtcclxuY2xhc3MgTWFpbiB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHQvL+agueaNrklEReiuvue9ruWIneWni+WMluW8leaTjlx0XHRcclxuXHRcdGlmICh3aW5kb3dbXCJMYXlhM0RcIl0pIExheWEzRC5pbml0KEdhbWVDb25maWcud2lkdGgsIEdhbWVDb25maWcuaGVpZ2h0KTtcclxuXHRcdGVsc2UgTGF5YS5pbml0KEdhbWVDb25maWcud2lkdGgsIEdhbWVDb25maWcuaGVpZ2h0LCBMYXlhW1wiV2ViR0xcIl0pO1xyXG5cdFx0TGF5YVtcIlBoeXNpY3NcIl0gJiYgTGF5YVtcIlBoeXNpY3NcIl0uZW5hYmxlKCk7XHJcblx0XHRMYXlhW1wiRGVidWdQYW5lbFwiXSAmJiBMYXlhW1wiRGVidWdQYW5lbFwiXS5lbmFibGUoKTtcclxuXHRcdExheWEuc3RhZ2Uuc2NhbGVNb2RlID0gR2FtZUNvbmZpZy5zY2FsZU1vZGU7XHJcblx0XHRMYXlhLnN0YWdlLnNjcmVlbk1vZGUgPSBHYW1lQ29uZmlnLnNjcmVlbk1vZGU7XHJcblx0XHQvL+WFvOWuueW+ruS/oeS4jeaUr+aMgeWKoOi9vXNjZW5l5ZCO57yA5Zy65pmvXHJcblx0XHRMYXlhLlVSTC5leHBvcnRTY2VuZVRvSnNvbiA9IEdhbWVDb25maWcuZXhwb3J0U2NlbmVUb0pzb247XHJcblxyXG5cdFx0Ly/miZPlvIDosIPor5XpnaLmnb/vvIjpgJrov4dJREXorr7nva7osIPor5XmqKHlvI/vvIzmiJbogIV1cmzlnLDlnYDlop7liqBkZWJ1Zz10cnVl5Y+C5pWw77yM5Z2H5Y+v5omT5byA6LCD6K+V6Z2i5p2/77yJXHJcblx0XHRpZiAoR2FtZUNvbmZpZy5kZWJ1ZyB8fCBMYXlhLlV0aWxzLmdldFF1ZXJ5U3RyaW5nKFwiZGVidWdcIikgPT0gXCJ0cnVlXCIpIExheWEuZW5hYmxlRGVidWdQYW5lbCgpO1xyXG5cdFx0aWYgKEdhbWVDb25maWcucGh5c2ljc0RlYnVnICYmIExheWFbXCJQaHlzaWNzRGVidWdEcmF3XCJdKSBMYXlhW1wiUGh5c2ljc0RlYnVnRHJhd1wiXS5lbmFibGUoKTtcclxuXHRcdGlmIChHYW1lQ29uZmlnLnN0YXQpIExheWEuU3RhdC5zaG93KCk7XHJcblx0XHRMYXlhLmFsZXJ0R2xvYmFsRXJyb3IgPSB0cnVlO1xyXG5cclxuXHRcdC8v5r+A5rS76LWE5rqQ54mI5pys5o6n5Yi277yMdmVyc2lvbi5qc29u55SxSURF5Y+R5biD5Yqf6IO96Ieq5Yqo55Sf5oiQ77yM5aaC5p6c5rKh5pyJ5Lmf5LiN5b2x5ZON5ZCO57ut5rWB56iLXHJcblx0XHRMYXlhLlJlc291cmNlVmVyc2lvbi5lbmFibGUoXCJ2ZXJzaW9uLmpzb25cIiwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLm9uVmVyc2lvbkxvYWRlZCksIExheWEuUmVzb3VyY2VWZXJzaW9uLkZJTEVOQU1FX1ZFUlNJT04pO1xyXG5cdH1cclxuXHJcblx0b25WZXJzaW9uTG9hZGVkKCk6IHZvaWQge1xyXG5cdFx0Ly/mv4DmtLvlpKflsI/lm77mmKDlsITvvIzliqDovb3lsI/lm77nmoTml7blgJnvvIzlpoLmnpzlj5HnjrDlsI/lm77lnKjlpKflm77lkIjpm4bph4zpnaLvvIzliJnkvJjlhYjliqDovb3lpKflm77lkIjpm4bvvIzogIzkuI3mmK/lsI/lm75cclxuXHRcdExheWEuQXRsYXNJbmZvTWFuYWdlci5lbmFibGUoXCJmaWxlY29uZmlnLmpzb25cIiwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLm9uQ29uZmlnTG9hZGVkKSk7XHJcblx0fVxyXG5cclxuXHRvbkNvbmZpZ0xvYWRlZCgpOiB2b2lkIHtcclxuXHRcdC8v5Yqg6L29SURF5oyH5a6a55qE5Zy65pmvXHJcblx0XHRHYW1lQ29uZmlnLnN0YXJ0U2NlbmUgJiYgTGF5YS5TY2VuZS5vcGVuKEdhbWVDb25maWcuc3RhcnRTY2VuZSk7XHJcblx0fVxyXG59XHJcbi8v5r+A5rS75ZCv5Yqo57G7XHJcbm5ldyBNYWluKCk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEJhbGxDdHJsIGV4dGVuZHMgTGF5YS5TY3JpcHQzRCB7XHJcblxyXG4gICAgcHJpdmF0ZSBjdXJCYWxsU3RhdGU6IEJhbGxTdGF0ZTtcclxuICAgIHByaXZhdGUgcmlnaWQ6IExheWEuUmlnaWRib2R5M0Q7XHJcblxyXG4gICAgcHJpdmF0ZSBtYXhGb3JjZTogbnVtYmVyID0gNi41O1xyXG4gICAgcHJpdmF0ZSBtaW5Gb3JjZTogbnVtYmVyID0gNC41O1xyXG4gICAgcHJpdmF0ZSBhZGRGb3JjZTogbnVtYmVyO1xyXG4gICAgcHJpdmF0ZSBncm91cFNwZWVkOiBudW1iZXI7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7IHN1cGVyKCk7IH1cclxuXHJcbiAgICBvbkF3YWtlKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMucmlnaWQgPSB0aGlzLm93bmVyLmdldENvbXBvbmVudChMYXlhLlJpZ2lkYm9keTNEKTtcclxuICAgICAgICBMYXlhLnN0YWdlLm9uKExheWEuRXZlbnQuTU9VU0VfRE9XTiwgdGhpcywgdGhpcy5vbk1vdXNlRG93bik7XHJcbiAgICAgICAgTGF5YS5zdGFnZS5vbihMYXlhLkV2ZW50Lk1PVVNFX1VQLCB0aGlzLCB0aGlzLm9uTW91c2VVcCk7XHJcbiAgICAgICAgdGhpcy5jdXJCYWxsU3RhdGUgPSBCYWxsU3RhdGUuSWRsZTtcclxuXHJcbiAgICAgICAgdGhpcy5ncm91cFNwZWVkID0gKHRoaXMubWF4Rm9yY2UgLSB0aGlzLm1pbkZvcmNlKSAvIDIuNTtcclxuICAgICAgICB0aGlzLmFkZEZvcmNlID0gMDtcclxuICAgIH1cclxuXHJcbiAgICBvblVwZGF0ZSgpOiB2b2lkIHtcclxuICAgICAgICB2YXIgZHQgPSBMYXlhLnRpbWVyLmRlbHRhIC8gMTAwMDtcclxuICAgICAgICBpZiAodGhpcy5jdXJCYWxsU3RhdGUgPT0gQmFsbFN0YXRlLkFkZEZvcmNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkRm9yY2UgKz0gZHQgKiB0aGlzLmdyb3VwU3BlZWQ7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkZEZvcmNlID4gdGhpcy5tYXhGb3JjZSAtIHRoaXMubWluRm9yY2UpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkRm9yY2UgPSB0aGlzLm1heEZvcmNlIC0gdGhpcy5taW5Gb3JjZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIHBlciA9IHRoaXMuYWRkRm9yY2UgLyAodGhpcy5tYXhGb3JjZSAtIHRoaXMubWluRm9yY2UpO1xyXG4gICAgICAgICAgICBwZXIgPSBwZXIgPiAxID8gMSA6IHBlcjtcclxuICAgICAgICAgICAgTGF5YS5zdGFnZS5ldmVudChcInNldF9zbGlkZXJfdmFsdWVcIiwgcGVyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25Nb3VzZURvd24oKTogdm9pZCB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJvbk1vdXNlRG93biFcIik7XHJcbiAgICAgICAgTGF5YS5zdGFnZS5ldmVudChcImhpZGVUd2VlbmVyXCIpO1xyXG4gICAgICAgIGlmICh0aGlzLmN1ckJhbGxTdGF0ZSAhPSBCYWxsU3RhdGUuSWRsZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY3VyQmFsbFN0YXRlID0gQmFsbFN0YXRlLkFkZEZvcmNlO1xyXG4gICAgfVxyXG5cclxuICAgIG9uTW91c2VVcCgpOiB2b2lkIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIm9uTW91c2VVcCFcIik7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VyQmFsbFN0YXRlICE9IEJhbGxTdGF0ZS5BZGRGb3JjZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY3VyQmFsbFN0YXRlID0gQmFsbFN0YXRlLlRocm93O1xyXG4gICAgICAgIHRoaXMudGhvcndCYWxsKCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhvcndCYWxsKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmN1ckJhbGxTdGF0ZSAhPSBCYWxsU3RhdGUuVGhyb3cpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc3BlZWQgPSB0aGlzLm1pbkZvcmNlICsgdGhpcy5hZGRGb3JjZTtcclxuICAgICAgICB2YXIgdnkgPSBzcGVlZCAqIE1hdGguc2luKE1hdGguUEkgLyA0KTtcclxuICAgICAgICB2YXIgdnogPSB2eTtcclxuXHJcbiAgICAgICAgdGhpcy5yaWdpZC5saW5lYXJWZWxvY2l0eSA9IG5ldyBMYXlhLlZlY3RvcjMoMCwgdnksIHZ6KTtcclxuICAgICAgICB0aGlzLnJpZ2lkLmdyYXZpdHkgPSBuZXcgTGF5YS5WZWN0b3IzKDAsIC0xMCwgMCk7XHJcblxyXG4gICAgICAgIExheWEudGltZXIub25jZSg1MDAwLCB0aGlzLCB0aGlzLm9uQ2hlY2tPdXQpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ2hlY2tPdXQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5vd25lci5yZW1vdmVTZWxmKCk7XHJcblxyXG4gICAgICAgIExheWEuc3RhZ2UuZXZlbnQoXCJnZW5fbmV3X2JhbGxcIik7XHJcbiAgICB9XHJcblxyXG4gICAgb25UcmlnZ2VyRW50ZXIob3RoZXI6IExheWEuUGh5c2ljc0NvbXBvbmVudCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmN1ckJhbGxTdGF0ZSA9PSBCYWxsU3RhdGUuTm9uZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIExheWEuc3RhZ2UuZXZlbnQoXCJzdWNjZXNzXCIpO1xyXG4gICAgICAgIHRoaXMuY3VyQmFsbFN0YXRlID0gQmFsbFN0YXRlLk5vbmU7XHJcbiAgICB9XHJcblxyXG4gICAgb25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgICAgIExheWEuc3RhZ2Uub2ZmKExheWEuRXZlbnQuTU9VU0VfRE9XTiwgdGhpcywgdGhpcy5vbk1vdXNlRG93bik7XHJcbiAgICAgICAgTGF5YS5zdGFnZS5vZmYoTGF5YS5FdmVudC5NT1VTRV9VUCwgdGhpcywgdGhpcy5vbk1vdXNlVXApO1xyXG4gICAgfVxyXG59XHJcbmVudW0gQmFsbFN0YXRlIHtcclxuICAgIE5vbmUsXHJcbiAgICBJZGxlLFxyXG4gICAgQWRkRm9yY2UsXHJcbiAgICBUaHJvd1xyXG59IiwiaW1wb3J0IEJhbGxDdHJsIGZyb20gXCIuL0JhbGxDdHJsXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lTWdyIGV4dGVuZHMgTGF5YS5TY3JpcHQge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKiBAcHJvcCB7bmFtZTpoU2xpZGVyLCB0aXBzOlwi6L+b5bqm5p2hXCIsIHR5cGU6Tm9kZSwgZGVmYXVsdDpudWxsfSovXHJcbiAgICBwdWJsaWMgaFNsaWRlcjogTGF5YS5IU2xpZGVyO1xyXG4gICAgLyoqIEBwcm9wIHtuYW1lOnNjb3JlVGV4dCwgdGlwczpcIuW+l+WIhlwiLCB0eXBlOk5vZGUsIGRlZmF1bHQ6bnVsbH0qL1xyXG4gICAgcHVibGljIHNjb3JlVGV4dDogTGF5YS5MYWJlbDtcclxuICAgIC8qKiBAcHJvcCB7bmFtZTpoaW50VGV4dCwgdGlwczpcIuW8gOWxgOWwj+aPkOekulwiLCB0eXBlOk5vZGUsIGRlZmF1bHQ6bnVsbH0qL1xyXG4gICAgcHVibGljIGhpbnRUZXh0OiBMYXlhLkxhYmVsO1xyXG5cclxuXHJcbiAgICBwcml2YXRlIGJhbGxfcHJlZmFiOiBhbnk7XHJcbiAgICBwcml2YXRlIHNjZW5lM0Q6IExheWEuU2NlbmUzRDtcclxuICAgIHByaXZhdGUgcGFydDogTGF5YS5TaHVyaUtlblBhcnRpY2xlM0Q7XHJcblxyXG4gICAgcHJpdmF0ZSBfc2NvcmU6IG51bWJlcjtcclxuICAgIHB1YmxpYyBnZXQgc2NvcmUoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2NvcmU7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgc2V0IHNjb3JlKHY6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuX3Njb3JlID0gdjtcclxuICAgICAgICB0aGlzLnNjb3JlVGV4dC50ZXh0ID0gdGhpcy5fc2NvcmUgKyBcIlwiO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgdHdlZW5lcjE6IExheWEuVHdlZW47XHJcbiAgICBwcml2YXRlIHR3ZWVuZXIyOiBMYXlhLlR3ZWVuO1xyXG5cclxuICAgIG9uQXdha2UoKTogdm9pZCB7XHJcbiAgICAgICAgTGF5YS5TY2VuZTNELmxvYWQoXCJyZXMvc2NlbmVzM0QvTGF5YVNjZW5lX2dhbWVfc2NlbmUvQ29udmVudGlvbmFsL2dhbWVfc2NlbmUubHNcIiwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLm9uTG9hZFNjZW5lQ21wKSk7XHJcbiAgICAgICAgTGF5YS5zdGFnZS5vbihcImdlbl9uZXdfYmFsbFwiLCB0aGlzLCB0aGlzLm9uR2VuTmV3QmFsbCk7XHJcbiAgICAgICAgTGF5YS5zdGFnZS5vbihcInNldF9zbGlkZXJfdmFsdWVcIiwgdGhpcywgdGhpcy5TZXRTbGlkZXJWYWx1ZSk7XHJcbiAgICAgICAgTGF5YS5zdGFnZS5vbihcInN1Y2Nlc3NcIiwgdGhpcywgdGhpcy5PbkdvYWwpO1xyXG4gICAgICAgIHRoaXMuU2V0U2xpZGVyVmFsdWUoMCk7XHJcbiAgICAgICAgdGhpcy5zY29yZSA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMudHdlZW5PdmVyMigpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIExheWEuc3RhZ2Uub24oXCJoaWRlVHdlZW5lclwiLCB0aGlzLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmhpbnRUZXh0LnZpc2libGUgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50d2VlbmVyMS5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50d2VlbmVyMi5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oaW50VGV4dC52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHR3ZWVuT3ZlcjEoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMudHdlZW5lcjEgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnR3ZWVuZXIxLmNsZWFyKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnR3ZWVuZXIyID0gTGF5YS5Ud2Vlbi50byh0aGlzLmhpbnRUZXh0LCB7IFwiYWxwaGFcIjogMSB9LDUwMCwgTGF5YS5FYXNlLmxpbmVhck5vbmUsIExheWEuSGFuZGxlci5jcmVhdGUodGhpcywgdGhpcy50d2Vlbk92ZXIyKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB0d2Vlbk92ZXIyKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLnR3ZWVuZXIyICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy50d2VlbmVyMi5jbGVhcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy50d2VlbmVyMSA9IExheWEuVHdlZW4udG8odGhpcy5oaW50VGV4dCwgeyBcImFscGhhXCI6IDAgfSwgNTAwLCBMYXlhLkVhc2UubGluZWFyTm9uZSwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLnR3ZWVuT3ZlcjEpKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBTZXRTbGlkZXJWYWx1ZSh2YWx1ZTogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHZhbHVlIDwgMCB8fCB2YWx1ZSA+PSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuaFNsaWRlci52YWx1ZSA9IHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgb25HZW5OZXdCYWxsKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuU2V0U2xpZGVyVmFsdWUoMCk7XHJcbiAgICAgICAgdmFyIG5ld2JhbGwgPSBMYXlhLlNwcml0ZTNELmluc3RhbnRpYXRlKHRoaXMuYmFsbF9wcmVmYWIpO1xyXG4gICAgICAgIHRoaXMuc2NlbmUzRC5hZGRDaGlsZChuZXdiYWxsKTtcclxuICAgIH1cclxuXHJcbiAgICAvL+W+l+WIhlxyXG4gICAgcHJpdmF0ZSBPbkdvYWwoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5wYXJ0Lm5hbWUpO1xyXG4gICAgICAgIHRoaXMucGFydC5wYXJ0aWNsZVN5c3RlbS5wbGF5KCk7XHJcbiAgICAgICAgdGhpcy5zY29yZSsrO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgb25Mb2FkU2NlbmVDbXAoc2NlbmVzM0Q6IExheWEuU2NlbmUzRCk6IHZvaWQge1xyXG4gICAgICAgIExheWEuc3RhZ2UuYWRkQ2hpbGQoc2NlbmVzM0QpO1xyXG5cclxuICAgICAgICB0aGlzLnNjZW5lM0QgPSBzY2VuZXMzRDtcclxuICAgICAgICBzY2VuZXMzRC56T3JkZXIgPSAtMTtcclxuICAgICAgICB2YXIgYmFsbCA9IHNjZW5lczNELmdldENoaWxkQnlOYW1lKFwiYmFsbFwiKTtcclxuICAgICAgICBiYWxsLmFkZENvbXBvbmVudChCYWxsQ3RybCk7XHJcblxyXG4gICAgICAgIHRoaXMuYmFsbF9wcmVmYWIgPSBMYXlhLlNwcml0ZTNELmluc3RhbnRpYXRlKGJhbGwgYXMgTGF5YS5TcHJpdGUzRCk7XHJcbiAgICAgICAgdGhpcy5wYXJ0ID0gc2NlbmVzM0QuZ2V0Q2hpbGRCeU5hbWUoXCJwYXJ0aWNsZVwiKSBhcyBMYXlhLlNodXJpS2VuUGFydGljbGUzRDtcclxuICAgIH1cclxuXHJcbiAgICBvbkVuYWJsZSgpOiB2b2lkIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIm9uRW5hYmxlISEhISFcIik7XHJcbiAgICB9XHJcblxyXG4gICAgb25EaXNhYmxlKCk6IHZvaWQge1xyXG4gICAgfVxyXG59Il19
